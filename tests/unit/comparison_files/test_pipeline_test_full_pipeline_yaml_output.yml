cdk-deploy-project-resources-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-unstable-project-resources
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-unstable-cdk-toolkit
    myapp-unstable-project-resources
  stage: deploy_project_resources_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-deploy-project-resources-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-dev-project-resources
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-dev-cdk-toolkit
    myapp-dev-project-resources
  stage: deploy_project_resources_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-project-resources-iat:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-iat-project-resources
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-iat-cdk-toolkit
    myapp-iat-project-resources
  stage: deploy_project_resources_iat
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-project-resources-tst:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-tst-project-resources
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-tst-cdk-toolkit
    myapp-tst-project-resources
  stage: deploy_project_resources_tst
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-windows-vm-bucket-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-unstable-windows-vm-bucket
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-unstable-cdk-toolkit
    myapp-unstable-windows-vm-bucket
  stage: deploy_windows_vm_bucket_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-deploy-windows-vm-intances-barista-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-dev-windows-vm-instances-barista
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-dev-cdk-toolkit
    myapp-dev-windows-vm-instances-barista
  stage: deploy_windows_vm_intances_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-windows-vm-intances-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-unstable-windows-vm-instances
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-unstable-cdk-toolkit
    myapp-unstable-windows-vm-instances
  stage: deploy_windows_vm_intances_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-deploy-windows-vm-intances-iat:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-iat-windows-vm-instances
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-iat-cdk-toolkit
    myapp-iat-windows-vm-instances
  stage: deploy_windows_vm_intances_iat
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-windows-vm-intances-impala-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-dev-windows-vm-instances-impala
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-dev-cdk-toolkit
    myapp-dev-windows-vm-instances-impala
  stage: deploy_windows_vm_intances_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-deploy-windows-vm-intances-tst:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - pip3 install --upgrade gcip
  - python3 -m gcip.script_library.wait_for_cloudformation_stack_ready --stack-name
    myapp-tst-windows-vm-instances
  - cdk deploy --strict --require-approval 'never' --toolkit-stack-name application-tst-cdk-toolkit
    myapp-tst-windows-vm-instances
  stage: deploy_windows_vm_intances_tst
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-project-resources-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-unstable-project-resources
  - cdk diff myapp-unstable-project-resources
  stage: diff_project_resources_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-diff-project-resources-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-dev-project-resources
  - cdk diff myapp-dev-project-resources
  stage: diff_project_resources_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-project-resources-iat:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-iat-project-resources
  - cdk diff myapp-iat-project-resources
  stage: diff_project_resources_iat
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-project-resources-tst:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-tst-project-resources
  - cdk diff myapp-tst-project-resources
  stage: diff_project_resources_tst
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-windows-vm-bucket-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-unstable-windows-vm-bucket
  - cdk diff myapp-unstable-windows-vm-bucket
  stage: diff_windows_vm_bucket_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-diff-windows-vm-intances-barista-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-dev-windows-vm-instances-barista
  - cdk diff myapp-dev-windows-vm-instances-barista
  stage: diff_windows_vm_intances_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-windows-vm-intances-unstable:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-unstable-windows-vm-instances
  - cdk diff myapp-unstable-windows-vm-instances
  stage: diff_windows_vm_intances_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
cdk-diff-windows-vm-intances-iat:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-iat-windows-vm-instances
  - cdk diff myapp-iat-windows-vm-instances
  stage: diff_windows_vm_intances_iat
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-windows-vm-intances-impala-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-dev-windows-vm-instances-impala
  - cdk diff myapp-dev-windows-vm-instances-impala
  stage: diff_windows_vm_intances_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
cdk-diff-windows-vm-intances-tst:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - cdk synth myapp-tst-windows-vm-instances
  - cdk diff myapp-tst-windows-vm-instances
  stage: diff_windows_vm_intances_tst
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
copy-windows-vm-image-dev:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - python3 update_windows_vm_image.py dev
  stage: copy_windows_vm_image_dev
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
copy-windows-vm-image-iat:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - python3 update_windows_vm_image.py iat
  stage: copy_windows_vm_image_iat
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
copy-windows-vm-image-tst:
  image: python:3.9-slim
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - python3 update_windows_vm_image.py tst
  stage: copy_windows_vm_image_tst
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: ==0.0.dev10
stages:
- diff_project_resources_unstable
- deploy_project_resources_unstable
- diff_windows_vm_bucket_unstable
- deploy_windows_vm_bucket_unstable
- update_windows_vm_image_unstable
- diff_windows_vm_intances_unstable
- deploy_windows_vm_intances_unstable
- diff_project_resources_dev
- deploy_project_resources_dev
- copy_windows_vm_image_dev
- diff_windows_vm_intances_dev
- deploy_windows_vm_intances_dev
- diff_project_resources_tst
- deploy_project_resources_tst
- copy_windows_vm_image_tst
- diff_windows_vm_intances_tst
- deploy_windows_vm_intances_tst
- diff_project_resources_iat
- deploy_project_resources_iat
- copy_windows_vm_image_iat
- diff_windows_vm_intances_iat
- deploy_windows_vm_intances_iat
update-windows-vm-image-unstable:
  image: python:3.9-slim
  rules:
  - allow_failure: false
    if: $CI_PIPELINE_SOURCE == "merge_request_event"
    when: never
  - allow_failure: false
    if: $IMAGE_SOURCE_PASSWORD
    when: on_success
  script:
  - git clone --branch master --single-branch https://gitlab-ci-token:${CI_JOB_TOKEN}@${CI_SERVER_HOST}/otherproject/configuration.git
  - ./install-dependencies.sh
  - python3 update_windows_vm_image.py unstable
  stage: update_windows_vm_image_unstable
  tags:
  - environment-iat
  variables:
    MYPROJECT_RELEASE_VERSION: '>=0.dev'
